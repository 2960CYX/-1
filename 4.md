ğŸ“– æœ€ç»ˆæ‰§è¡Œæ–‡æ¡£ï¼šv1.2.1ï¼ˆåç«¯ API å°±ç»ªç‰ˆï¼‰
ğŸ¯ ç›®æ ‡ï¼šå®Œæˆ RuoYi åç«¯è°ƒæ•´ï¼Œä½¿åšå®¢ç›¸å…³ API èƒ½è¢« Vitesse å‰ç«¯ç›´æ¥è°ƒç”¨ï¼Œå¹¶ä¿è¯åŸç‰ˆåå°å¯ä»¥æ­£å¸¸ç™»å½•ä¸é€€å‡ºã€‚

âš™ï¸ Git ç­–ç•¥ï¼š
- åŸºå‡†åˆ†æ”¯ï¼š`v1.2`
- åˆ›å»ºå·¥ä½œåˆ†æ”¯ï¼š`git checkout -b v1.2.1`

v1.2.1 ä»»åŠ¡åˆ—è¡¨ï¼ˆçº¯åç«¯ï¼‰

ğŸ¯ ä»»åŠ¡ 1.1ï¼šé…ç½® CORS è·¨åŸŸç­–ç•¥  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-framework/src/main/java/com/ruoyi/framework/config/ResourcesConfig.java`  
æ“ä½œï¼šåœ¨ `corsFilter()` ä¸­ä½¿ç”¨æœ€å®½æ¾çš„å…è®¸æºé…ç½®ï¼Œç¡®ä¿åŒ…å«æ‰€æœ‰ localhost è®¿é—®ï¼ˆå«ä¸åŒç«¯å£ï¼‰ã€‚  

```java
// æ›¿æ¢å†å²çš„ config.addAllowedOrigin("http://localhost") å†™æ³•
config.addAllowedOriginPattern("*");
```

ğŸ¯ ä»»åŠ¡ 1.2ï¼šé…ç½® Security å…¨å±€ç™½åå•  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-framework/src/main/java/com/ruoyi/framework/config/SecurityConfig.java`  
æ“ä½œï¼šåœ¨ `authorizeHttpRequests` çš„ `.antMatchers(...)` ä¸­ï¼Œæ–°å¢åšå®¢å‰å°å’ŒåŸç‰ˆåå°è°ƒè¯•æ¥å£çš„åŒ¿åè®¿é—®æƒé™ã€‚  

```java
.antMatchers(
    "/login", "/register", "/captchaImage",
    "/blog/**",     // Vitesse åšå®¢ API
    "/dev-api/**",  // RuoYi åŸç‰ˆåå°è°ƒè¯• API
    "/common/download**"
).permitAll()
```

ğŸ¯ ä»»åŠ¡ 1.3ï¼šå¼€æ”¾â€œæ–‡ç« â€API çš„æ–¹æ³•çº§æƒé™  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogArticleController.java`  
æ“ä½œï¼šæ³¨é‡Š `list()` ä¸ `getInfo()` æ–¹æ³•ä¸Šçš„ `@PreAuthorize` æ³¨è§£ï¼Œç¡®ä¿å‰å°èƒ½è¯»å–æ–‡ç« åˆ—è¡¨åŠè¯¦æƒ…ã€‚  

ğŸ¯ ä»»åŠ¡ 1.4ï¼šå¼€æ”¾â€œåˆ†ç±»â€API çš„æ–¹æ³•çº§æƒé™  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogCategoryController.java`  
æ“ä½œï¼šæ³¨é‡Š `list()` æ–¹æ³•ä¸Šçš„ `@PreAuthorize` æ³¨è§£ã€‚  

ğŸ¯ ä»»åŠ¡ 1.5ï¼šå¼€æ”¾â€œæ ‡ç­¾â€API çš„æ–¹æ³•çº§æƒé™  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogTagController.java`  
æ“ä½œï¼šæ³¨é‡Š `list()` æ–¹æ³•ä¸Šçš„ `@PreAuthorize` æ³¨è§£ã€‚  

ğŸ¯ ä»»åŠ¡ 1.6ï¼šå¼€æ”¾â€œè¯„è®ºâ€API çš„æ–¹æ³•çº§æƒé™  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogCommentController.java`  
æ“ä½œï¼šæ³¨é‡Š `list()` ä¸ `add()` æ–¹æ³•ä¸Šçš„ `@PreAuthorize` æ³¨è§£ï¼Œå…è®¸å‰å°å±•ç¤ºè¯„è®ºå¹¶æäº¤è®¿å®¢è¯„è®ºã€‚  

ğŸ¯ ä»»åŠ¡ 1.7ï¼šä¿®å¤â€œæ–‡ç« è¯¦æƒ…â€SQL æŸ¥è¯¢åˆ«å  
æ–‡ä»¶ï¼š`api/RuoYi-Vue/ruoyi-admin/src/main/resources/mapper/blog/BlogArticleMapper.xml`  
æ“ä½œï¼šç¡®è®¤ `selectBlogArticleByArticleId` çš„ `WHERE` å­å¥ä½¿ç”¨è¡¨åˆ«å `ba`ã€‚  

```xml
<select id="selectBlogArticleByArticleId" parameterType="Long" resultMap="BlogArticleResult">
    <include refid="selectBlogArticleVo"/>
    where ba.article_id = #{articleId}
</select>
```

âœ… æäº¤ä¸éªŒè¯
1. æš‚å­˜ä¿®æ”¹ï¼š`git add api/`
2. æäº¤è®°å½•ï¼š`git commit -m "v1.2.1: åç«¯APIå°±ç»ªï¼Œä¿®å¤CORSã€Securityè·¯å¾„å¹¶å¼€æ”¾åšå®¢æ¥å£"`
   - å¦‚é‡é’©å­é˜»æ­¢æäº¤ï¼Œå¯è¿½åŠ  `--no-verify`ã€‚
3. ç¼–è¯‘ï¼šåœ¨ `api/RuoYi-Vue/` ç›®å½•æ‰§è¡Œ `mvn clean package -DskipTests`
4. å¯åŠ¨ï¼šè¿è¡Œ `java -jar ruoyi-admin/target/ruoyi-admin.jar`
5. éªŒè¯ï¼š
   - è®¿é—® `http://localhost`ï¼Œå¼ºåˆ¶åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰
   - èƒ½æˆåŠŸç™»å½•å¹¶é€€å‡ºåå°ï¼›æµè§ˆå™¨æ§åˆ¶å°æ—  403
   - Vitesse å‰ç«¯è¯·æ±‚åšå®¢/è¯„è®ºæ¥å£åº”è¿”å› 200

ğŸ“Œ è¯´æ˜ï¼šä»¥ä¸Šä¸ºåŸºäº v1.2 çš„æœ€å°æ”¹åŠ¨é›†ï¼Œå¯ä¸€æ¬¡æ€§å®Œæˆåç«¯å¼€æ”¾ä¸éªŒè¯ã€‚
