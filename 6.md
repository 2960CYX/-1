# v1.2.2 前端整合进度

## 已完成
- 前端项目 `web/my-vitesse-app/` 已通过 `pnpm add axios` 引入 axios 依赖，并自动更新锁文件
- 新增 `.env.development.local`，将 `VITE_API_BASE_URL` 指向 `http://localhost:8080`
- 新增 `src/utils/request.js`，封装 RuoYi 风格的 axios 请求与响应拦截逻辑
- 首页 `src/pages/index.vue` 完成文章列表、分页、标签筛选、加载状态等逻辑替换
- 详情页 `src/pages/article/[id].vue` 实现文章详情、标签映射、评论列表与提交表单
- `.gitignore` 补充本地环境文件忽略规则；类型声明文件已由路由自动导入插件重新生成
- 运行 `pnpm run build`（通过）

## 待处理
- 尚未对接真实后端联调（需先启动 RuoYi 后端，再 `pnpm run dev` 验证请求）
- 未新增自动化测试，线上验证依赖手工检查
- 当前改动尚未执行 `git add/commit`

## 备注
- 若后端地址不同，请调整 `.env.development.local` 的 `VITE_API_BASE_URL`
- 如需继续本地开发，建议 `pnpm run dev` 并检查分页、标签/评论接口是否可用

## 2025-11-01 博客文章接口保护补充（by Codex）
- 发现问题：匿名访问 `/blog/article/list` 未显式传 `status` 时会把草稿（`status=0`）和逻辑删除（`del_flag=2`）一并返回。
- 处理动作：
  - `v1/api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogArticleController.java`：增加访客检测逻辑，默认强制 `status=1` 与 `delFlag=0`，导入 `SecurityUtils`、`Authentication`、`AnonymousAuthenticationToken`、`StringUtils`；保留原有代码，仅追加逻辑。
  - `v1/api/RuoYi-Vue/ruoyi-admin/src/main/resources/mapper/blog/BlogArticleMapper.xml`：列表查询通过 `<choose>` 兜底 `del_flag='0'`，详情查询追加 `del_flag='0'` 条件，避免误返回逻辑删除数据。
- 验证建议：
  - 未登录情况下请求 `/blog/article/list?categoryId=101` 仅应看到已发布文章。
  - 管理端若需查看草稿，可手动传 `status=0`，逻辑删除数据仍默认隐藏。
- 后续提示：后期若实现访客登录无需再调整；若要在后台查看逻辑删除记录，可考虑新增管理员专用接口或放宽 Mapper 条件。

## 2025-11-02 标签筛选后端补充（by Codex）
- 现状：前端首页已支持通过 `tagId` 请求参数筛选文章，但后端 `selectBlogArticleList` 未处理该参数，导致筛选无效。
- 处理动作：
  - `v1/api/RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/blog/controller/BlogArticleController.java`：`list` 方法新增可选参数 `Long tagId`，若传入则写入 `blogArticle.getParams()`，避免调整 Service/Mapper 接口签名。
  - `v1/api/RuoYi-Vue/ruoyi-admin/src/main/resources/mapper/blog/BlogArticleMapper.xml`：在列表查询 `<where>` 中加入 `params.tagId` 条件，通过 `exists` 子查询关联 `blog_article_tag` 实现按标签过滤。
- 验证建议：
  - 调用 `/blog/article/list?tagId=XXX` 确认仅返回已绑定该标签的文章。
  - 同时带上 `categoryId`、`status` 等参数时依旧可组合筛选。
