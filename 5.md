第二份文档：v1.2.2 (Vitesse 前端整合版)
 目标：基于 v1.2.1 的后端，在 web/my-vitesse-app/ 目录中实现完整的前端功能。

 Git 策略：

确保你已完成 v1.2.1 的所有工作并已提交。

git checkout v1.2.1 (切换到已就绪的后端分支)。

git checkout -b v1.2.2 (创建 v1.2.2 分支用于存放前端修改)。

v1.2.2 任务列表 (纯前端)
 任务 2.1：为前端安装 Axios

目录: web/my-vitesse-app/

操作: pnpm add axios

 任务 2.2：创建前端本地环境变量

创建文件: web/my-vitesse-app/.env.development.local

操作: 写入以下内容，并确保 [您的后端API地址] (如 http://localhost:8080) 正确。

代码段

# RuoYi 后端的 API 地址
VITE_API_BASE_URL=[您的后端API地址]
 任务 2.3：创建前端 API 请求工具 (request.js)

创建文件: web/my-vitesse-app/src/utils/request.js

操作: 粘贴以下全部内容到 request.js 文件中：

JavaScript

import axios from 'axios'

// 创建 axios 实例
const service = axios.create({
  // 自动从 .env 文件读取 VITE_API_BASE_URL
  baseURL: import.meta.env.VITE_API_BASE_URL, 
  timeout: 10000, 
})

// 响应拦截器 (RuoYi 专用)
service.interceptors.response.use(
  (res) => {
    const code = res.data.code || 200
    const msg = res.data.msg

    if (code === 200) {
      return res.data // 成功，直接返回整个 { code, msg, rows, data } 对象
    } else {
      console.error('[API Error] ' + msg)
      alert(msg || 'API Error') // 简单弹窗提示
      return Promise.reject(new Error(msg))
    }
  },
  (error) => {
    console.error('[Network Error] ' + error)
    alert('网络错误，请稍后再试')
    return Promise.reject(error)
  },
)

export default service
 任务 2.4：更新前端首页 (index.vue)

文件: web/my-vitesse-app/src/pages/index.vue

操作: 覆盖所有内容，粘贴以下全部代码：

代码段

<script setup>
import { ref, reactive, onMounted, watch } from 'vue'
import request from '~/utils/request' // 导入我们刚创建的工具

const articleList = ref([])
const categoryList = ref([])
const tagList = ref([])
const loading = ref(true)

// 响应式的查询参数
const queryParams = reactive({
  categoryId: null,
  tagId: null,
})

// ---- 辅助函数 ----
function formatDisplayDate(dateTimeString) {
  if (!dateTimeString) return '未知日期'
  try {
    return dateTimeString.split(' ')[0] // 只取 YYYY-MM-DD
  } catch (e) {
    return dateTimeString
  }
}

// 获取文章列表 (现在会响应 queryParams 的变化)
async function getArticleList() {
  try {
    loading.value = true
    // res 的结构是 { code, msg, rows, total }
    const res = await request.get('/blog/article/list', {
      params: queryParams, // 传递动态查询参数
    })
    articleList.value = res.rows || []
  } catch (error) {
    console.error('获取文章列表失败:', error)
  } finally {
    loading.value = false
  }
}

// 获取分类列表
async function getCategoryList() {
  try {
    const res = await request.get('/blog/category/list')
    categoryList.value = res.rows || []
  } catch (error) {
    console.error('获取分类列表失败:', error)
  }
}

// 获取标签列表
async function getTagList() {
  try {
    const res = await request.get('/blog/tag/list')
    tagList.value = res.rows || []
  } catch (error) {
    console.error('获取标签列表失败:', error)
  }
}

// 筛选方法
function filterByCategory(categoryId) {
  queryParams.categoryId = categoryId
  queryParams.tagId = null // 重置另一个筛选
}
function filterByTag(tagId) {
  queryParams.categoryId = null // 重置另一个筛选
  queryParams.tagId = tagId
}
function clearFilters() {
  queryParams.categoryId = null
  queryParams.tagId = null
}

// 监视 queryParams 的变化，自动重新获取文章
watch(queryParams, getArticleList, { deep: true })

// 页面加载时，获取所有数据
onMounted(() => {
  getArticleList()
  getCategoryList()
  getTagList()
})
</script>

<template>
  <div p-8 max-w-1000px m-auto grid="~ cols-1 md:cols-3 gap-8">
    <aside class="col-span-1">
      <div class="sidebar-box">
        <h3 text-xl font-semibold mb-4>分类</h3>
        <ul>
          <li mb-2>
            <a href="#" @click.prevent="clearFilters()" text-blue-500 hover:underline>全部文章</a>
          </li>
          <li v-for="category in categoryList" :key="category.categoryId" mb-2>
            <a href="#" @click.prevent="filterByCategory(category.categoryId)" hover:underline>
              {{ category.name }}
            </a>
          </li>
        </ul>
      </div>

      <div class="sidebar-box mt-8">
        <h3 text-xl font-semibold mb-4>标签</h3>
        <div flex="~ wrap gap-2">
          <span
            v-for="tag in tagList" :key="tag.tagId"
            @click="filterByTag(tag.tagId)"
            bg-gray-100 p="x-3 y-1" rounded-full text-sm cursor-pointer hover:bg-blue-100
          >
            {{ tag.name }}
          </span>
        </div>
      </div>
    </aside>

    <main class="col-span-1 md:col-span-2">
      <h1 text-3xl font-bold mb-6>
        我的博客
      </h1>
      <div v-if="loading" text-gray-500>正在加载...</div>
      <div v-else>
        <div v-if="articleList.length > 0">
          <div v-for="article in articleList" :key="article.articleId" border-b border-gray-200 py-6>
            <router-link :to="`/article/${article.articleId}`">
              <h2 text-2xl font-semibold hover:text-blue-600>{{ article.title }}</h2>
            </router-link>
            <p text-gray-700 mt-2>{{ article.summary }}</p>
            <div text-sm text-gray-500 mt-4>
              <span>分类：{{ article.categoryName }}</span>
              <span mx-2>|</span>
              <span>发布于：{{ formatDisplayDate(article.createTime) }}</span>
            </div>
          </div>
        </div>
        <div v-else text-gray-500>
          暂无文章。
        </div>
      </div>
    </main>
  </div>
</template>

<style scoped>
.sidebar-box ul {
  list-style-type: none;
  padding-left: 0;
}
</style>
 任务 2.5：创建/更新前端详情页 ([id].vue)

创建文件: web/my-vitesse-app/src/pages/article/[id].vue

操作: 覆盖所有内容，粘贴以下全部代码：

代码段

<script setup>
import { ref, onMounted, computed, reactive } from 'vue'
import { useRoute } from 'vue-router'
import request from '~/utils/request'

const route = useRoute()
const articleId = computed(() => route.params.id) 

const article = ref(null)
const allTags = ref([]) // 存储所有标签
const commentList = ref([]) // 存储评论
const loading = ref(true)

// 新评论的表单
const newComment = reactive({
  nickname: '',
  content: '',
  articleId: articleId.value,
  parentId: 0, // 0 表示对文章的直接评论
})

// ---- 数据获取 ----

// 1. 获取文章详情
async function getArticleDetail() {
  try {
    const res = await request.get(`/blog/article/${articleId.value}`)
    article.value = res.data 
  } catch (error) {
    console.error('获取文章详情失败:', error)
  }
}

// 2. 获取所有标签 (用于映射名称)
async function getAllTags() {
  try {
    const res = await request.get('/blog/tag/list')
    allTags.value = res.rows || []
  } catch (error) {
    console.error('获取所有标签失败:', error)
  }
}

// 3. 获取评论列表
async function getCommentList() {
  try {
    const res = await request.get('/blog/comment/list', {
      params: {
        articleId: articleId.value,
      }
    })
    commentList.value = res.rows || []
  } catch (error) {
    console.error('获取评论列表失败:', error)
  }
}

// ---- 计算属性 ----

// 计算文章的标签名称 (TagID 映射为 TagName)
const articleTags = computed(() => {
  if (!article.value || !article.value.tagIds || !allTags.value.length) {
    return []
  }
  return article.value.tagIds.map(tagId => {
    const found = allTags.value.find(t => t.tagId === tagId)
    return found ? found.name : '未知标签'
  })
})

// ---- 辅助函数 ----

function formatDisplayDate(dateTimeString) {
  if (!dateTimeString) return '未知日期'
  try {
    return dateTimeString.split(' ')[0] // 只取 YYYY-MM-DD
  } catch (e) {
    return dateTimeString 
  }
}

// ---- 提交评论 ----
async function submitComment() {
  if (!newComment.nickname || !newComment.content) {
    alert('昵称和内容不能为空！')
    return
  }
  try {
    // 调用 RuoYi API 提交
    await request.post('/blog/comment', newComment)

    // 成功
    alert('评论成功！(如果后端设置了审核，可能需要等待审核)')
    newComment.content = '' // 清空内容
    await getCommentList() // 刷新评论列表

  } catch (error) {
    console.error('提交评论失败:', error)
  }
}

// 页面加载时，并行获取所有需要的数据
onMounted(async () => {
  loading.value = true
  await Promise.all([
    getArticleDetail(),
    getAllTags(),
    getCommentList()
  ])
  loading.value = false
})
</script>

<template>
  <div p-8 max-w-800px m-auto>
    <div v-if="loading" text-gray-500>正在加载文章...</div>

    <div v-if="article">
      <h1 text-4xl font-bold mb-4>{{ article.title }}</h1>
      <div text-gray-500 mb-8>
        <span>分类：{{ article.categoryName || '未分类' }}</span>
        <span mx-2>|</span>
        <span>发布于：{{ formatDisplayDate(article.createTime) }}</span>
      </div>

      <div class="article-content" v-html="article.content" />

      <div v-if="articleTags.length" mt-8>
        <strong>标签：</strong>
        <span
          v-for="tagName in articleTags" :key="tagName"
          bg-gray-100 p-2 rounded-full text-sm mr-2
        >
          {{ tagName }}
        </span>
      </div>
    </div>

    <div class="comment-section mt-12">
      <h2 text-2xl font-semibold mb-6>评论区</h2>

      <div v-if="commentList.length > 0">
        <div v-for="comment in commentList" :key="comment.commentId" border-b border-gray-200 py-4>
          <strong text-lg>{{ comment.nickname }}</strong>
          <span text-sm text-gray-500 ml-2>({{ formatDisplayDate(comment.createTime) }})</span>
          <p mt-2 text-gray-700>{{ comment.content }}</p>
        </div>
      </div>
      <div v-else text-gray-500>
        暂无评论，快来抢沙发吧！
      </div>

      <div class="comment-form mt-8">
        <h3 text-xl font-semibold mb-4>发表评论</h3>
        <form @submit.prevent="submitComment">
          <div mb-4>
            <label for="nickname" block mb-2>昵称：</label>
            <input
              id="nickname" v-model="newComment.nickname"
              type="text" required
              p-2 border rounded w-full md:w-1/2
            >
          </div>
          <div mb-4>
            <label for="comment" block mb-2>内容：</label>
            <textarea
              id="comment" v-model="newComment.content"
              rows="4" required
              p-2 border rounded w-full
            />
          </div>
          <button
            type="submit"
            bg-blue-500 text-white p="x-4 y-2" rounded
            hover:bg-blue-600
          >
            提交评论
          </button>
        </form>
      </div>
    </div>

    <router-link to="/" block mt-12 text-blue-500 hover:underline>
      &lt; 返回首页
    </router-link>
  </div>
</template>

<style>
/* 建议: 将这个 style 块移动到 /src/styles/main.css 或全局样式表 */
.article-content p { line-height: 1.8; margin-bottom: 1.5em; }
.article-content h1, .article-content h2, .article-content h3 { font-weight: 600; margin-top: 2em; margin-bottom: 1em; }
.article-content img { max-width: 100%; border-radius: 8px; }
.article-content pre { background-color: #f4f4f4; padding: 1em; border-radius: 8px; overflow-x: auto; }
.article-content blockquote { border-left: 4px solid #ccc; padding-left: 1em; margin-left: 0; font-style: italic; color: #555; }
</style>
 任务 2.6：配置前端 Git 忽略文件

文件: web/my-vitesse-app/.gitignore

操作: 在文件末尾追加以下内容：

代码段


# 本地环境变量 (包含敏感配置)
.env.local
.env.*.local
v1.2.2 完成与提交
暂存所有前端修改：

Bash

git add web/
提交 v1.2.2 版本：

Bash

# 别忘了，你可能需要用 --no-verify 来跳过 pnpm 钩子
git commit -m "v1.2.2: 完成Vitesse前端整合，实现博客首页、详情页及评论" --no-verify
推送 (可选)：

Bash

git push origin v1.2.2
全栈启动与验证：

启动后端 (v1.2.1)：确保 [您的后端API地址] 正在运行。

启动前端 (v1.2.2)：在 web/my-vitesse-app/ 目录运行 pnpm run dev。

验证：打开 Vitesse 网址 [您的前端运行地址] (如 http://localhost:3335)，验证首页、筛选、详情页、评论提交等所有功能是否全部正常。